# 尚硅谷JavaWeb学习笔记

[TOC]

## 写在前面

学习链接：[Java Web 视频教程全集（103P）](https://www.bilibili.com/video/av59545633/)

**特别注意**：该内容全是我自学时，一边听课一边做的笔记，本文的初衷是**希望每一个学习时有疑问的同学能够在这篇文章里找到答案**；里面关于吐槽的内容仅代表个人看法，白嫖党不会针对任何老师或书籍发表不合适的看法，如有冒犯，请见谅。所有传播知识的行为都应该受到尊重，该内容涉及的一切只为学习交流使用，希望每个求知进来的读者都可以满载而归。有任何问题或侵权行为，请联系本人**李英俊小朋友**，我会回应并删除；另外，做笔记真的不容易，希望大家转载时标明作者，若非个人使用的转载，请联系本人，否则必究。

学习体会：

## 1. 前言

- 在Sun的JavaServlet规范中：JavaWeb应用由一组Servlet、HTML页、类、以及其他可以被绑定的资源构成。它可以在各种供应商提供的**实现Servlet规范的Servlet容器中运行**。

- JavaWeb应用中可以包含如下内容：

  - Servlet
  - JSP
  - 实用类
  - 静态文档如HTML、图片等
  - 描述Web应用的信息（web.xml）

- Servlet与Servlet容器

  ![在这里插入图片描述](https://img-blog.csdnimg.cn/20200409124223247.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIxNTc5MDQ1,size_16,color_FFFFFF,t_70)

- Servlet容器的概念

  - Servlet容器为JavaWeb应用提供运行时的环境，它负责管理Servlet和JSP的生命周期，以及管理它们的共享数据。
  - Servlet容器也称为JavaWeb应用容器，或者Servlet/HSP容器。
  - 目前最流行的Servlet容器软件包括：
    - Tomcat
    - Resin
    - J2EE服务器（如Weblogic）中也提供了内置的Servlet容器

- **Tomcat**：Apache、Sun和其他一些公司及个人共同开发完成。

  - Tomcat的目录层次结构

    ![在这里插入图片描述](https://img-blog.csdnimg.cn/20200409125526469.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIxNTc5MDQ1,size_16,color_FFFFFF,t_70)

  - 运行Tomcat

    1. 配置java_home或jre_home（这一步我能运行哈哈哈哈，我用的tomcat9）
    2. 双击bin目录下的startup.bat文件
    3. 在地址栏中输入http://localhost:8080/
    4. 若已经启动了一个Tomcat应用，若再启动同一个Tomcat应用，则会抛出异常（这是因为端口被占用了）

  - 关闭Tomcat&配置Tomcat的端口号

    1. 双击bin目录下的shutdown.bat文件关闭Tomcat服务器

    2. 修改Tomcat默认的端口号：

       - 打开conf目录下的server.xml文件
       - 修改端口号

       ![在这里插入图片描述](https://img-blog.csdnimg.cn/20200409130844768.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIxNTc5MDQ1,size_16,color_FFFFFF,t_70)

  - catalina：可以通过设置catalina_home环境变量的方式来通过dos启动关闭tomcat

    - 为了可以在任意目录下启动Tomcat服务器

    1. 把Tomcat的bin目录添加到path下（但是这样添加成功会，通过startup启动Tomcat会有提示：catalina的环境变量没有正确设置）
    2. 设置CATALINA_HOME环境变量：
       1. 通过阅读startup.bat文件可知，该环境变量下有一个bin目录，而bin目录下又有一个catalina.bat文件，由此可知CATALINA_HOME指向的应该是Tomcat安装的根目录
       2. 于是把Tomcat的根目录设为CATALINA_HOME环境变量
       3. 此时即可以在任意根目录下通过startup.bat、shutdown.bat启动、关闭Tomcat服务器
       4. 继续阅读startup.bat文件，发现启动tomcat服务器的是catalina.bat文件，在命令行窗口直接输入catalina会有各种命令的提示，出现各种可选参数。
       5. 常用的有：run（同窗口启动服务器）、start（新窗口启动服务器）、stop（关闭服务器）

  - Tomcat的管理程序

    - Tomcat提供了一个管理程序：manager，用于部署到Tomcat服务器中的web应用程序
    - 要访问manager web应用程序，需要添加具有管理员权限的账号，编辑conf目录下的**tomcat-users.xml**文件，添加manager角色，设置用户名和密码
    - **注意**：这里我在操作的时候，发现我用的是tomcat9嘛，所以跟视频里面将的不一样，设置的时候发现仅仅设置manager是不行的，并且**tomcat-users.xml**文件中也说了不同的用户对应着不同的管理权限，不像以前直接manager用户管所有了，因此为了解决这个问题查了百度，[参考链接](http://blog.sina.com.cn/s/blog_6ac4c6cb0101485d.html)，这样就解决了。另外，不能像视频中设置用户和密码为空，不然一直弹框也进不去。

## 2. Web程序结构

- 一个web应用程序是由一组Servlet，HTML页面，类，以及其他的资源组成的运行在web服务器上的完整的应用程序，以一种结构化的有层次的目录形式存在。

- 组成web应用程序的这些文件要部署在相应的目录层次中，根目录代表整个web应用程序的“根”。

- 通常将web应用程序的目录放在webapps目录下，在webapps目录下的每一个子目录都是一个独立的web应用程序，子目录的名字就是web应用程序的名字，也就是web应用程序的“根”。用户通过web应用程序的“根”来访问web应用程序中的资源。

- Servlet规范汇总定义了web应用程序的目录层次

  ![在这里插入图片描述](https://img-blog.csdnimg.cn/20200409153613329.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIxNTc5MDQ1,size_16,color_FFFFFF,t_70)

- **注意**：跟着视频在创建jsp文件的时候，我发现并没有这个新建这个文件的选择，网上搜了搜方法，据说是：“IDEA认为我这个包建的有问题，才导致这地方不应该创建jsp文件，所以就没有创建JSP文件的选项。” [参考连接](https://blog.csdn.net/weixin_44381073/article/details/89816624)，采用这个方法之后就可以新建jsp文件了。

- JSP(Java Server Pages)是由Sun Microsystems公司倡导、许多公司参与一起建立的一种动态网页技术标准。

- 第一个WEB应用程序：开发，并部署到Tomcat服务器下运行

  1. 新建一个JavaProject
  2. 在Java项目下创建WEB开发的目录结构
     - WebContent
       - WEN-INF
         - classes 编译后的class文件必须放在该目录下
         - lib
         - web.xml （从Tomcatwebapps\docs\WEB-INFO中复制过来，可以不做修改）
       - html 页面
       - jsp 页面
       - 图片。。。
  3. 在src下新建一个Person类
  4. 手工的Person类对应的Class文件（含包）复制到classes目录下
     - 可以通过修改默认的输出目录达到自动把编译好的class放到classes目录下
     - 由于视频中是eclipse操作的，因此我搜了一下idea的[操作方法](https://www.cnblogs.com/dslx/p/10172602.html)
  5. 在WebContent目录下新建一个JSP文件
  6. 把WebContent目录复制到Tomcat的webapps目录下，并改名为helloworld
  7. 在浏览器的地址栏中输入http://localhost:8080/WebContent/hello.jsp即可看到命令行打印的信息
  8. 使用【配置任意目录下Web应用程序2】的方式建立.xml文件，实现直接部署

- 配置任意目录下Web应用程序1

  - 在Web服务器中可以配置虚拟目录，而虚拟目录所对应的真实目录可以在任何路径下
  - 在Tomcat服务器中，主要在XML配置文件中通过`<Context>`元素的设置来完成的。一个`<Context>`元素就表示一个Web应用程序，运行在特定的虚拟主机中
  - `<Context>`元素是`<Host>`元素的子元素，可以在conf\server.xml文件中设置Context元素
  - 使用docBase属性指定Web应用程序的真实路径。将属性reloadable设置为true，Tomcat在运行时会自动监测Servlet类的改动，如果发现有类被更新，Tomcat服务器将自动重新加载该Web应用程序。这样，在开发时，就不需要频繁重启Tomcat了。

- 配置任意目录下Web应用程序2（超酷）

  - 还可以在conf目录下一次创建Catalina\localhost目录，然后在localhost目录下为test这个Web应用程序建立test.xml文件，编辑这个文件输入以下内容`<Context path="/test" docBase="c:/test" reloadable="true">`
  - 从Tomcat5开始，**不建议直接在server.xml文件中配置`<Context>`元素**，因为server.xml文件作为Tomcat的主要配置文件，一旦Tomcat启动后，将不会再读取这个文件，因此无法在Tomcat服务器启动时发布Web应用程序。如果在其他地方配置`<Context>`元素，那么在Tomcat运行时，也可以发布Web应用程序。
  - 从Tomcat5.5开始，在\conf\Catalina\localhost目录下创建XML配置文件来配置Web应用程序，**Tomcat将以XML文件的文件名作为Web应用程序的上下文路径**，而不会理会在`<Context>`元素的path属性中指定的上下文路径是什么。由于Tomcat5.5之后的版本是以XML配置文件的文件名作为Web应用程序的上下文路径的，因此在配置`<Context>`元素时，可以不使用path属性。

- 文件修改为helloworld2.xml

  ```xml
  <?xml version="1.0" encoding="UTF-8" ?>
  <Context path="/test2" docBase="F:/BookStudy/else/JavaWebPro/WebContent" reloadable="true"/>
  ```

- 上述内容的解释

  ![在这里插入图片描述](https://img-blog.csdnimg.cn/20200409173352178.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIxNTc5MDQ1,size_16,color_FFFFFF,t_70)

- **之前没有实现自动化的结果这里就不展示了**

- 自动化包含了两个，具体实现方法在上面

  - 一是将class输出的位置放到WebContent/WEB-INF/classes下
  - 二是通过配置任意目录下Web应用程序（使用第2种方法），把后面的原路径映射道虚拟路径上，实现实时更新项目的目的，这样修改了原始项目的内容，也可以不用重启Tomcat直接展示最新的结果。

- 报错问题：

  - org.apache.jasper.JasperException: Unable to compile class for JSP:
  - JSP出现 类名 cannot be resolved to a type
  - 上面两种问题是同一页面出现的。。。我查了一万个方法。。。最后发现是WEB-INF写成WEB-INFO了
  - 所以出了问题的第一件事情，一定要从自己这里找原因。。。哭！

- 最后运行成功的图如下：

  ![在这里插入图片描述](https://img-blog.csdnimg.cn/20200409171814200.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIxNTc5MDQ1,size_16,color_FFFFFF,t_70)

## 3. 使用Eclipse / Idea开发JavaWeb项目









------

我的博客园：https://www.cnblogs.com/lyjun/

我的Github：https://github.com/TinyHandsome

纸上得来终觉浅，绝知此事要躬行~

欢迎大家过来OB~

by 李英俊小朋友